---
import { getCollection } from "astro:content";
import ProfileCard from "@/components/profile-card.astro";
import Layout from "@/layouts/main.astro";

const allProfiles = await getCollection("profiles");

// Sort: featured first, then by order
const sortedProfiles = allProfiles.sort((a, b) => {
	if (a.data.featured && !b.data.featured) return -1;
	if (!a.data.featured && b.data.featured) return 1;
	return (a.data.order || 0) - (b.data.order || 0);
});

const content = {
	title: "Chattini Profiles - Chattinisona",
};
---

<Layout {content}>
	<main class="min-h-screen bg-gradient-to-br from-primary/5 via-background to-accent/5">
		<div class="container mx-auto px-4 py-12 max-w-7xl">
			<header class="text-center mb-16">
				<h1 class="retro text-3xl md:text-4xl mb-6 text-primary">
					Meet the Chattini
				</h1>
				<p class="text-lg text-muted-foreground max-w-2xl mx-auto">
					Discover the vibrant personalities that make up our amazing fan community!
				</p>
			</header>

			<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
				{sortedProfiles.map((profile) => (
					<ProfileCard
						name={profile.data.name}
						lore={profile.data.lore}
						image={profile.data.image}
						imageAlt={profile.data.name}
						tags={profile.data.tags}
						category={profile.data.category}
						slug={profile.id}
						featured={profile.data.featured}
					/>
				))}
			</div>
		</div>
	</main>
</Layout>
